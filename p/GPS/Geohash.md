---
title: Geohash
aliases:
  - Geohash
tags:
  - GPS
---




Geohashって何？
================================================================================
地球上のある範囲を表す文字列。点ではなく範囲なのがポイント。
そして文字列長が精度も兼ねていて、短くなるほど範囲が広くなる、長くなるほど正確になる。

表現される範囲
================================================================================
ここにまとめてある

グリッドとしても座標表現としても使える

Geohash - Geographic/Photogrammetric/Cartographic
http://d.hatena.ne.jp/hfu/20080603/1212439145

単位が秒なので、mに直すと・・・1秒が約31mと換算すると・・
メッシュサイズはこんな感じになる

| 文字数 | サイズ              |
| ------ | ----------------- |
| 1文字  | 5022000m四方   |
| 9文字  | 4.789345m四方 |

`Android携帯` 等の `GPS` での精度では `15m` ほどと言われているので実用的には `9文字` でほぼOK
`7文字`にすると `120m` ほどのメッシュサイズになってしまって点を表すにはやや荒い


頭 x の意味
================================================================================
日本の `Geohash` を調べるといつも頭に `x` がつく、これはどういう理由だろうか？
という出発点からのデコード

ここ参考
Geohash - Wikipedia, the free encyclopedia
http://en.wikipedia.org/wiki/Geohash


`x` は `Wikipedia`の `BASE32` の資料を参考すると `29` を表す。
これを5ビットで表現すると

```
29 / 2 = 14 ...1  .1
14 / 2 = 7  ...0  .2
7  / 2 = 3  ...1  .4
3  / 2 = 1  ...1  .8
1  / 2 = 0  ...1  .16
```

ってことで `11101` ということになる

ビットを経度緯度経度緯度と経度を先にして交互に2分割する。

```
| 緯度 | 1 | 0 |   |
| 経度 | 1 | 1 | 1 |
```

緯度とは北極と南極を結ぶ線上位置を表すもので赤道をゼロとして北側が `0` 〜 `+90` 度、南側が`0` 〜 `-90` 度で表現される。

そして、一番左のビットから絞り込んでいく。
今一番左のビットは `1` なので北側にあるということになる。確かに日本は北半球にあるからね。

`0` 〜 `+90` の範囲をさらに2分割して `0` 〜 `45`、`45` 〜 `90` の範囲に分割する。
次のビットは `0` なので

`0` 〜 `45` 度の範囲ということになる。確かに日本の緯度は

日本の緯度経度一覧 - Wikipedia
http://ja.wikipedia.org/wiki/%E6%97%A5%E6%9C%AC%E3%81%AE%E7%B7%AF%E5%BA%A6%E7%B5%8C%E5%BA%A6%E4%B8%80%E8%A6%A7

から見ても `24` 〜 `43` 度の間になっていることがわかる。

同様の操作を経度に対しても行うと・・・`-180` 〜 `180` の範囲でビットが `1` なので `0〜180`、
次のビットも `1` なので `90〜180`、次のビットも1なので `125〜180`

確かに緯度経度では、`124度〜141度` の間に収まっている。

頭の `x` でこの精度なのだから2文字ほどで日本ほどのサイズは表現できるよう。

ここからわかることは1文字あたり、経度方向で3ビット精度があるので文字数を増やすことによって、急速に範囲が狭まるということ。
1文字増やすだけでも8倍も範囲が狭まってしまう
つまり1文字の担当範囲を減らすことで精度は上げられる・・・つまりエンコードなんかしなくて平ビットで保存すればいいのでは？

最初の `x` はそういう意味。

