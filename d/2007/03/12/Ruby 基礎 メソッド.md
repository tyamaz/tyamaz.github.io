---
title: Ruby / 基礎 / メソッド
aliases:
  - Ruby / 基礎 / メソッド
tags:
  - d/2007/03/12
---

Ruby 1.8.6


ブロックを受け取るメソッド
================================================================================

宣言部
--------------------------------------------------------------------------------
処理ブロックを受け取るためには特に何も必要ない。なぜなら `Ruby` ではブロックを1個しか受け取れないので、メソッドにとっては自明だからである。


```ruby
def hoge(a, b, c)
end
```

しかし明示的に受け取りたい場合は `＆(アンパサンド)` をつけて変数を一番最後にとりつける。
一番最後以外には取り付けられない。

```ruby
def hoge(a, b, c, &d)
end
```

こう記述すると仮引数 `d` に処理ブロックの `Procオブジェクト` が格納される。

うけとった処理ブロックの処理を使う
--------------------------------------------------------------------------------
処理ブロックは1個しか渡すことができないので使う側からすれば特定可能なので名前が必要無い。
使うときは `yeild` というキーワードを使う。

```ruby
def hoge(a, b, c)
  yeild()
end
```

このキーワードが受け取ったブロックを表すProcオブジェクトの呼び出しになる。

明示的に仮引数を割り当てた場合は、内部で

```ruby
def hoge(a, b, c, &d)
  d.call()
end
```

このように `call` というメソッドを呼び出して実行する



処理ブロック中の制御
--------------------------------------------------------------------------------

### 戻り値を返す
処理ブロックから戻り値をメソッドに渡すには何もしなくてよい。最後に評価された値がそのままメソッドに戻る。

`return` なんてやっちゃうと、ブロック構文を設置しているメソッド自体を抜けてしまう

### 渡したメソッドから脱出する
処理ブロックの中の指定でブロックを渡したメソッド自体から脱出できる。


ブロック
```
break
```

で脱出できる。


### 処理ブロックから脱出する(eachならば１回分を終了させる)

`next` で処理ブロックを脱出することができる。`break` は処理ブロックではなくて処理ブロックを渡したメソッド丸々終了させるのに対して、`next` は処理ブロックのみを終了させる。

`next` というキーワードになっているのは `eachメソッド` に渡すブロックで `continue` キーワードの代わりによく使うからでしょう

### もう一度処理ブロックを実行する
`redo` キーワードで処理ブロックに渡す引数を同一にして実行しなおすことができる。


### ブロック中の self キーワード
これはブロックが作られた場所の `self` と同じになる。ブロックの中と外とでは `self` は同じものを指す。


