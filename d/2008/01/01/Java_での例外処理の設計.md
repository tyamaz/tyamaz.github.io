---
title: Javaでの 例外処理の設計
aliases:
  - Java_での例外処理の設計
tags:
  - d/2008/01/01
  - n/PGM/Java/設計/例外
---

- ※↓2022年現在の考えで見ると、設計がややわかってないというか仕様のことが頭に無い感じはする。
- ※以下2008年時点のややできないプログラマの考え。


どの言語でもありげな `try-catch`。
設計においては、例外処理はメソッドの責任範囲を明確にするってことだが・・・これが結構難しい。

例外を発生させつつバシバシ突き進むようにコードすればいいのか？それとも極力例外を発生させないようにコードすべきか？

例外を発生させないようにコードすると、コードのほとんどが例外条件を除外するif文の嵐になり・・・なんかこれって昔ながらとかわんないし、なんかダサい。
かといって、ロジック中に例外が必ず含まれる前提で組み込むのも気持ちがわるい・・・正常な動きであれば例外が発生しないように記述したいってのもある。

なんだこれ

これは本当に難しい話っていうか好みでしょうかね・・・

これはオブ脳の著者の例外に対する説明のページですけど・・[例外(Exception)脳の作り方](http://www.geocities.jp/objectbrain/exceptionbrain.html)

なんか違和感。

ログイン失敗を例外処理するってのが・・・ログイン失敗ってのは普通に起きるようなことで、こいつを例外処理で実装すると、使う側も例外発生前提でロジックを組むことになる。

こういう単純動作を例外としていいのはAPIのような広範囲に使われて、機能が非常に限定されているものだけのような気がする
通常の高度な機能の処理まで例外を持ち込むと、例外処理が単なるbreak処理にになりかねないのでやばいと思うんだよね

こういう場合はloginメソッドで成功失敗を返して、getUserInfoメソッドでユーザー情報を返すのが好みか。

・・・考えると、普通にアプリ組むだけだったら例外処理ってあんまり書かないような気がする。




脳内だけで考察
================================================================================
外部から挙動をコントロールするには、オブジェクト状態と引数でしかコントロールできない。
つまり想定するオブジェクト状態以外、想定する引数以外を例外として処理すればいいわけなんだが、
こう考えると、例外処理を記述するということは、上位の処理での例外処理の正常系化を促すことになるね

そこには電気回路でいうグランドのような一番外側に処理を捨てる場所が必要になってくる・・・seaserのひがさんもキャッチせずに全部フレームワークまでブン投げるって言ってるね。

うーんまた難しい。

では、例外を発生させまくるロジックで組むとどうなるか？

例外を発生させまくる前提で書くと、引数チェックとかはメソッド自体に押し込んで、外側からは何のチェックも無しにいきなり使うことになる。

そこは `try-catch` で挟んで、例外処理を記述する。すると外側では引数チェック処理がなくなる。
メソッドを使うたびにチェックロジックを書かなくていいのでこれはこれで便利だし、DRY思想にも当てはまる、バグの混入も防げる。

これの問題は・・・使いやすくしたことでメソッドの使う状況が著しく制限されることだろう。責任範囲が極めて狭く、少しでも間違えたら例外処理・・・引数で戻せば（コードで戻すのではなく、そのように使えるようにメソッド分割すると）対処は豊富な構文で行うことができるが、例外の場合はcatchオンリーなのだ、これだとちょっと別のメソッドと組み合わせて使うだけで、おそらく `try-catch` のネストの嵐になるのは結構目に見えてくる

やはりチェックはチェック、例外は例外にしたほうがいいね・・・2008年初頭時点では私の結論はどの言語でもそういうことにしておこう

・・・って調べてたらこんなのも出てきた

C#と諸々 .NET 例外処理 <http://csharper.blog57.fc2.com/blog-category-1.html>

やっぱりみんな揺らいでるのねｗ

例外をインターセプトすべきか

<http://blogs.wankuma.com/shuujin/archive/2006/01/16/20641.aspx>

ここがみんなの意見なのかな・・・




参考サイト
================================================================================
- [例外機構を“正しく”使う - ITアーキテクト IT Architect](http://www.itarchitect.jp/technology_and_programming/-/10249-3.html)
- [Exception - 例外に萌えてみる](http://fieldnotes.sytes.net/wiki/index.jsp?pid=Exception)
- [「エラーの原因ごとに例外の型を別ける」のはどうなの? - うなの日記 ](http://d.hatena.ne.jp/unageanu/20070830/1188476810)






