---
title: Mercurial 一人で使ってみる（Windows編）
aliases:
  - Mercurial_一人で使ってみる（Windows編）
tags:
  - d/2009/12/01
  - n/PGM/VCS/Hg
---

- 2009年12月01日

サンプルプロジェクト
================================================================================
とりあえずサンプルプロジェクトを作りますか。
よくあるWebサイトの管理をしてみます。

```
 hoge01
  +-index.html
  +-images
     +logo.jpg
  +-css
     +index.css
```


こんな感じにしてみます
`hoge01` は `My Document` 直下においてみます。


リポジトリを作る
================================================================================
`hoge01` のディレクトリまで移動して

```
$ cd hoge01
```

リポジトリを初期化します

```
$ cd init
```

`hoge01` の中に `.hg` というディレクトリができました。　これがリポジトリですな。
分散なのでこれが全部

管理されているファイルの確認とコミット準備
================================================================================

``` 
$ hg status
```

そうするとはてなマークが行頭についた3行が出ると思われる。
はてなは知らんよって意味なので、管理されてないことを意味している

ここで

```
$ hg add **/*.jpg
```

と打つ

こうすると管理ディレクトリ以下のjpgファイルをすべてリポジトリに加えたことになった

もう一度確認してみるとはてながとれていることがわかる

さらに打ち込んで全部のファイルをリポジトリに登録する

```
$ hg *.html
$ hg css/index.css
```

確認したら全部行頭に `A` がつきました。

これで全部管理対象に入りました。
この時点では入っただけで管理はまだされていません、コミットで管理が始まります。




コミットする
================================================================================

```
$ hg commit
```

と打ち込むと設定したエディタが立ち上がって、コミットメッセージを求められます。
私はgvimを使っているのでgvimが起動しました

もうすでに何か入力されていますがこれは単なる注釈なのでなんの意味も無いですから
適当に削除して

```
first commit.
```

とでも書いて保存終了します。

そうすると commit が完了します

ちゃんとcommitできたか確認してみます

```
$ hg log -v
```

ズラズラ出たらOK


変更してコミットする
================================================================================
では `index.html` を適当に変更してコミットしてみよう

変更して保存して、また

```
$ hg status
```

をやってみるとこんどは

```
M index.html
```

と表示されると思う。変更アリというしるしだ。

コミットしてみる

```
$ hg commit
```


確認

```
$ hg log -v
```

OK

巻き戻す
================================================================================
バージョン管理の醍醐味巻き戻しをやります。

現状の作業状態を破棄、特定のリビジョンに全体を巻き戻す
--------------------------------------------------------------------------------
あんまりありませんね・・・こんな状況。
無駄にコミットしまくった挙句、モーヤダって時用でしょうか、現状ではリビジョンは 最初の状態の0と変更後の1があります。

もう一度変更をかけてコミットしないでおきます。これで作業中リビジョン0、1とが全部違う状態になります。

まずリポジトリの履歴を確かめて初期状態まで巻き戻します

```
$ hg log
$ hg update -C 0
```

これで元に戻りました。Cオプションは強制巻き戻しです。現状の変更を無視してとりあえずリビジョン0の状態まで戻します。

```
$ hg log
```

するとわかりますが、あくまで作業状態がリビジョン0の状態と同一になっただけでリポジトリの履歴には何の影響も無いです。

特定ファイルだけを特定リビジョンの状態にする
--------------------------------------------------------------------------------
これはよくやりますね。操作するのは特定の1ファイルだけです。↑のupdateは管理ファイル全体をそのリビジョン状態にするコマンドだったわけです。

現状はindex.htmlがリビジョン0の状態になっているのでこいつだけリビジョン1にします

```
$ hg revert -r index.html
```


履歴を確認すればわかりますが作業中のファイルは元に戻りましたがリポジトリは無傷です。

コレぐらい操作できるようになっていれば下っ端の開発者なら作業進めれますね。
